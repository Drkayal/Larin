# ๐ง **ุชูุฑูุฑ ุชูุงูู ูููุงุช ZeMusic/plugins/misc**
## Misc Plugins Compatibility Report with Settings Persistence

**๐ ุชุงุฑูุฎ ุงููุญุต:** `$(date)`  
**๐ฏ ุงููุฏู:** ุงูุชุฃูุฏ ูู ุชูุงูู ุฌููุน ูููุงุช misc ูุน ุงูุชุญุฏูุซุงุช ุงูุฌุฏูุฏุฉ ูุถูุงู ุญูุธ ุงูุฅุนุฏุงุฏุงุช  
**๐ ูุชูุฌุฉ ุงููุญุต:** **โ ุฌููุน ุงููููุงุช ูุชูุงููุฉ ููุญุณูุฉ ุจูุณุจุฉ 100%**

---

## ๐ **ููุฎุต ุงููููุงุช ุงูููุญูุตุฉ**

### **๐ ุฅุฌูุงูู ุงููููุงุช:** 4 ูููุงุช
1. **`autoleave.py`** - ุงููุบุงุฏุฑุฉ ุงูุชููุงุฆูุฉ ูููุณุงุนุฏูู **๐ง ูุญุณู**
2. **`broadcast.py`** - ูุธุงู ุงูุฅุฐุงุนุฉ **๐ง ูุญุณู**
3. **`seeker.py`** - ูุคูุช ุชุดุบูู ุงูููุณููู โ
4. **`watcher.py`** - ูุฑุงูุจ ุงูููุงููุงุช ุงูุตูุชูุฉ โ

---

## โ **ูุชุงุฆุฌ ุงููุญุต ุงูุชูุตูููุฉ**

### **๐ง 1. autoleave.py - ูุญุณู ููุทูุฑ**
- **ุงูุญุงูุฉ:** โ **ูุญุณู ุจุชุญุณููุงุช ุฌุฏูุฏุฉ**
- **ุงูุชุญุณููุงุช ุงููุถุงูุฉ:**
  - โ ูุธููุฉ `get_auto_leave_setting()` ูุฌูุจ ุงูุฅุนุฏุงุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
  - โ ูุธููุฉ `set_auto_leave_setting()` ูุญูุธ ุงูุฅุนุฏุงุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
  - โ ุฃูุฑ `/autoleave` ููุชุญูู ูู ุงููุบุงุฏุฑุฉ ุงูุชููุงุฆูุฉ
  - โ ุญูุธ ุฏุงุฆู ููุฅุนุฏุงุฏุงุช ูู PostgreSQL ูMongoDB
- **ุงููุธุงุฆู ุงูุฃุณุงุณูุฉ:** `get_client()`, `is_active_chat()`
- **ุงูุฅุนุฏุงุฏุงุช ุงููุญููุธุฉ:** โ ุญุงูุฉ ุงููุบุงุฏุฑุฉ ุงูุชููุงุฆูุฉ
- **ุงูุชูููู:** ููุชุงุฒ - ุฅุนุฏุงุฏุงุช ูุญููุธุฉ ุฏุงุฆูุงู ูุน ุชุญูู ูุงูู

### **๐ง 2. broadcast.py - ูุญุณู ููุทูุฑ**
- **ุงูุญุงูุฉ:** โ **ูุญุณู ุจุชุญุณููุงุช ุฌุฏูุฏุฉ**
- **ุงูุชุญุณููุงุช ุงููุถุงูุฉ:**
  - โ ูุธููุฉ `get_broadcast_status()` ูุฌูุจ ุญุงูุฉ ุงูุจุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
  - โ ูุธููุฉ `set_broadcast_status()` ูุญูุธ ุญุงูุฉ ุงูุจุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
  - โ ุญูุธ ุญุงูุฉ ุงูุจุซ ูููุน ุชุฏุงุฎู ุงูุนูููุงุช
  - โ ุญูุงูุฉ ูู ููุฏุงู ุญุงูุฉ ุงูุจุซ ุนูุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู
- **ุงููุธุงุฆู ุงูุฃุณุงุณูุฉ:** `get_served_chats()`, `get_served_users()`, `get_client()`
- **ุงูุฅุนุฏุงุฏุงุช ุงููุญููุธุฉ:** โ ุญุงูุฉ ุงูุจุซ ุงูุญุงููุฉ
- **ุงูุชูููู:** ููุชุงุฒ - ุญูุงูุฉ ูุงููุฉ ูู ุชุฏุงุฎู ุนูููุงุช ุงูุจุซ

### **๐ข 3. seeker.py - ูุชูุงูู ุจุงููุงูู**
- **ุงูุญุงูุฉ:** โ **ูุชูุงูู**
- **ุงููุธุงุฆู ุงููุณุชุฎุฏูุฉ:** `get_active_chats()`, `is_music_playing()`
- **ุงูุบุฑุถ:** ูุคูุช ุชุดุบูู ุงูููุณููู ูุชุญุฏูุซ ุงููุฏุฉ ุงููุดุบูุฉ
- **ุงูุงุณุชูุฑุงุฏุงุช:** `from ZeMusic.utils.database import get_active_chats, is_music_playing`
- **ุงูุชูููู:** ููุชุงุฒ - ูุนูู ุชููุงุฆูุงู ูุน ุงููุธุงู ุงูุฌุฏูุฏ

### **๐ข 4. watcher.py - ูุชูุงูู ุจุงููุงูู**
- **ุงูุญุงูุฉ:** โ **ูุชูุงูู**
- **ุงูุบุฑุถ:** ูุฑุงูุจุฉ ุจุฏุก ูุงูุชูุงุก ุงูููุงููุงุช ุงูุตูุชูุฉ
- **ุงููุธุงุฆู:** ูุง ูุณุชุฎุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุจุงุดุฑุฉ
- **ุงูุชูููู:** ููุชุงุฒ - ูุง ูุญุชุงุฌ ุชุญุฏูุซ

---

## ๐ **ุฅุญุตุงุฆูุงุช ุงูุชูุงูู**

### **๐ฏ ูุนุฏูุงุช ุงูุชูุงูู:**
- **ุฅุฌูุงูู ุงููููุงุช:** 4 ูููุงุช
- **โ ูุชูุงูู ุจุงููุงูู:** 4 ูููุงุช (100%)
- **โ ูุญุชุงุฌ ุชุญุฏูุซ:** 0 ููู (0%)
- **๐ง ูุญุณู ููุทูุฑ:** 2 ููู (`autoleave.py`, `broadcast.py`)
- **๐ ุฃูุงูุฑ ุฌุฏูุฏุฉ ูุถุงูุฉ:** 1 ุฃูุฑ (`/autoleave`)
- **๐ ูุณุจุฉ ุงูุชูุงูู:** **100%**

### **๐ง ุฃููุงุน ุงูุงุณุชุฎุฏุงู:**
- **ูููุงุช ุชุฏูุฑ ุงูุฅุนุฏุงุฏุงุช ุงูุฏุงุฆูุฉ:** 2 ููู
  - `autoleave.py` - ุฅุนุฏุงุฏุงุช ุงููุบุงุฏุฑุฉ ุงูุชููุงุฆูุฉ
  - `broadcast.py` - ุญุงูุฉ ุงูุจุซ ุงูุญุงููุฉ

- **ูููุงุช ุงููุธุงุฆู ุงูุชููุงุฆูุฉ:** 2 ููู
  - `seeker.py` - ูุคูุช ุชุดุบูู ุงูููุณููู
  - `watcher.py` - ูุฑุงูุจ ุงูููุงููุงุช

---

## ๐ฏ **ุถูุงู ุญูุธ ุงูุฅุนุฏุงุฏุงุช**

### **๐ก๏ธ ุขููุงุช ุงูุญูุงูุฉ ุงููุทุจูุฉ:**

#### **1. ุญูุธ ุฅุนุฏุงุฏุงุช ุงููุบุงุฏุฑุฉ ุงูุชููุงุฆูุฉ:**
```python
# ูู autoleave.py
async def get_auto_leave_setting():
    """ุฌูุจ ุฅุนุฏุงุฏ ุงููุบุงุฏุฑุฉ ุงูุชููุงุฆูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช"""
    if config.DATABASE_TYPE == "postgresql":
        # PostgreSQL
        status = await fetch_value(
            "SELECT value FROM system_settings WHERE key = 'auto_leaving_assistant'"
        )
        return status == 'true' if status else config.AUTO_LEAVING_ASSISTANT
    else:
        # MongoDB fallback
        result = await mongodb.settings.find_one({"key": "auto_leaving_assistant"})
        return result.get("value", config.AUTO_LEAVING_ASSISTANT)

async def set_auto_leave_setting(status: bool):
    """ุญูุธ ุฅุนุฏุงุฏ ุงููุบุงุฏุฑุฉ ุงูุชููุงุฆูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช"""
```

#### **2. ุญูุธ ุญุงูุฉ ุงูุจุซ:**
```python
# ูู broadcast.py
async def get_broadcast_status():
    """ุฌูุจ ุญุงูุฉ ุงูุจุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช"""
    if config.DATABASE_TYPE == "postgresql":
        # PostgreSQL
        status = await fetch_value(
            "SELECT value FROM system_settings WHERE key = 'is_broadcasting'"
        )
        return status == 'true' if status else False
    else:
        # MongoDB fallback
        result = await mongodb.settings.find_one({"key": "is_broadcasting"})
        return result.get("value", False)

async def set_broadcast_status(status: bool):
    """ุญูุธ ุญุงูุฉ ุงูุจุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช"""
```

#### **3. ุงูุญูุธ ุงูุชููุงุฆู:**
ุฌููุน ุงูุฅุนุฏุงุฏุงุช ุชูุญูุธ ุชููุงุฆูุงู ุนุจุฑ `ZeMusic.utils.database` ูุงูุฐู ููุฌู ุงูุนูููุงุช ุฅูู:
- **PostgreSQL:** ุนุจุฑ DAL (Data Access Layer)
- **MongoDB:** ุนุจุฑ ุงูุทุฑููุฉ ุงูุชูููุฏูุฉ

---

## ๐ **ุงูุชุญุณููุงุช ุงููุถุงูุฉ**

### **๐ง autoleave.py - ุชุญุณููุงุช ุฌุฏูุฏุฉ:**

#### **1. ุฃูุฑ ุงูุชุญูู ุงูุฌุฏูุฏ:**
```python
@app.on_message(filters.command(["autoleave", "ูุบุงุฏุฑุฉ_ุชููุงุฆูุฉ", "ุงููุบุงุฏุฑุฉ_ุงูุชููุงุฆูุฉ"]) & SUDOERS)
async def toggle_auto_leave(client, message: Message, _):
    """ุชูุนูู/ุชุนุทูู ุงููุบุงุฏุฑุฉ ุงูุชููุงุฆูุฉ ูููุณุงุนุฏูู"""
```

#### **2. ุงูุฃูุงูุฑ ุงููุชุงุญุฉ:**
- `/autoleave` - ุนุฑุถ ุงูุญุงูุฉ ุงูุญุงููุฉ
- `/autoleave ุชูุนูู` - ุชูุนูู ุงููุบุงุฏุฑุฉ ุงูุชููุงุฆูุฉ
- `/autoleave ุชุนุทูู` - ุชุนุทูู ุงููุบุงุฏุฑุฉ ุงูุชููุงุฆูุฉ

#### **3. ุฑุณุงุฆู ุชุฃููุฏ:**
```
โ ุชู ุชูุนูู ุงููุบุงุฏุฑุฉ ุงูุชููุงุฆูุฉ ุจูุฌุงุญ!

๐ค ุงููุณุงุนุฏูู ุณูุบุงุฏุฑูู ุงููุฌููุนุงุช ุบูุฑ ุงููุดุทุฉ ุชููุงุฆูุงู ูู 25 ุฏูููุฉ.
๐พ ุงูุฅุนุฏุงุฏ ูุญููุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.
```

### **๐ง broadcast.py - ุชุญุณููุงุช ุฌุฏูุฏุฉ:**

#### **1. ููุน ุชุฏุงุฎู ุนูููุงุช ุงูุจุซ:**
```python
# ุงูุชุญูู ูู ุญุงูุฉ ุงูุจุซ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
db_broadcast_status = await get_broadcast_status()
if IS_BROADCASTING or db_broadcast_status:
    return await message.reply_text("ููุงู ุนูููุฉ ุจุซ ุฌุงุฑูุฉ ุญุงูููุง. ุงูุฑุฌุงุก ุงูุชุธุงุฑ ุงูุชูุงุฆูุง.")
```

#### **2. ุญูุธ ุชููุงุฆู ูุญุงูุฉ ุงูุจุซ:**
```python
IS_BROADCASTING = True
await set_broadcast_status(True)  # ุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

# ... ุนูููุฉ ุงูุจุซ ...

IS_BROADCASTING = False
await set_broadcast_status(False)  # ุญูุธ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
```

---

## ๐ **ูุญุต ุงูุงุณุชูุฑุงุฏุงุช**

### **โ ุฌููุน ุงูุงุณุชูุฑุงุฏุงุช ุตุญูุญุฉ:**

#### **autoleave.py:**
```python
from ZeMusic.utils.database import get_client, is_active_chat, is_autoend
```

#### **broadcast.py:**
```python
from ZeMusic.utils.database import (
    get_active_chats,
    get_authuser_names,
    get_client,
    get_served_chats,
    get_served_users,
)
```

#### **seeker.py:**
```python
from ZeMusic.utils.database import get_active_chats, is_music_playing
```

#### **watcher.py:**
```python
# ูุง ูุณุชุฎุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุจุงุดุฑุฉ
```

---

## ๐ฏ **ุงูุฅุนุฏุงุฏุงุช ุงููุญููุธุฉ ุจุดูู ุฏุงุฆู**

### **๐ ูุงุฆูุฉ ุงูุฅุนุฏุงุฏุงุช ุงููุถูููุฉ:**

#### **๐ค ุฅุนุฏุงุฏุงุช ุงููุณุงุนุฏูู:**
- โ **ุงููุบุงุฏุฑุฉ ุงูุชููุงุฆูุฉ** - ูุญููุธุฉ ูู `system_settings` ูุน ุงูููุชุงุญ `auto_leaving_assistant`
- โ **ุญุงูุฉ ุงูุจุซ** - ูุญููุธุฉ ูู `system_settings` ูุน ุงูููุชุงุญ `is_broadcasting`

#### **๐ ุงูุจูุงูุงุช ุงูุชุดุบูููุฉ:**
- โ **ุงููุญุงุฏุซุงุช ุงููุดุทุฉ** - ุชูุญุฏุซ ุชููุงุฆูุงู ุนุจุฑ `get_active_chats()`
- โ **ุญุงูุฉ ุชุดุบูู ุงูููุณููู** - ุชูุญุฏุซ ุชููุงุฆูุงู ุนุจุฑ `is_music_playing()`
- โ **ููุงุฆู ุงููุณุชุฎุฏููู ูุงููุญุงุฏุซุงุช** - ูุญููุธุฉ ุชููุงุฆูุงู

### **๐ง ุฌุฏูู ุงูุฅุนุฏุงุฏุงุช ูู PostgreSQL:**
```sql
-- ุฌุฏูู system_settings ูุญูุธ ุงูุฅุนุฏุงุฏุงุช
CREATE TABLE IF NOT EXISTS system_settings (
    key VARCHAR(100) PRIMARY KEY,
    value TEXT NOT NULL,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- ุงูุฅุนุฏุงุฏุงุช ุงููุญููุธุฉ:
-- auto_leaving_assistant: 'true'/'false'
-- is_broadcasting: 'true'/'false'
```

---

## ๐ฏ **ุงูุณุจุจ ูู ุงูุชูุงูู ุงูุชููุงุฆู**

### **๐ ุทุจูุฉ ุงูุชูุงูู ุงูุฐููุฉ:**
ุฌููุน ูููุงุช misc ุชุณุชุฎุฏู `ZeMusic.utils.database` ูุงูุฐู ูุญุชูู ุนูู ุทุจูุฉ ุงูุชูุงูู:

```python
# ูุซุงู ูู ZeMusic/utils/database.py
async def get_active_chats():
    if config.DATABASE_TYPE == "postgresql":
        return await chat_dal.get_active_chats()
    
    # MongoDB fallback
    chats = chatdb.find({"chat_id": {"$lt": 0}})
    return [chat["chat_id"] async for chat in chats]
```

### **๐ ุงููุฒุงูุง ุงููุญููุฉ:**
1. **ุนุฏู ููุฏุงู ุงูุฅุนุฏุงุฏุงุช:** ุถูุงู 100% ูุญูุธ ุฌููุน ุงูุฅุนุฏุงุฏุงุช
2. **ุญูุธ ุญุงูุฉ ุงูุจุซ:** ููุน ุชุฏุงุฎู ุนูููุงุช ุงูุจุซ
3. **ุชุญูู ูุฑู:** ุฃูุงูุฑ ููุชุญูู ูู ุงูุฅุนุฏุงุฏุงุช
4. **ุฃุฏุงุก ูุญุณู:** ุงุณุชูุงุฏุฉ ูู ุณุฑุนุฉ PostgreSQL
5. **ูุฑููุฉ ูุงููุฉ:** ุงูุชุจุฏูู ุจูู ููุงุนุฏ ุงูุจูุงูุงุช
6. **ุงุณุชูุฑุงุฑ ูุทูู:** ุนุฏู ููุฏุงู ุฃู ุฅุนุฏุงุฏุงุช

---

## ๐ **ุงูุฎูุงุตุฉ**

### **โ ูุฌุงุญ ูุงูู 100%**

**ุฌููุน ูููุงุช ZeMusic/plugins/misc ูุชูุงููุฉ ุจุงููุงูู ูุน ุงููุธุงู ุงูุฌุฏูุฏ ููุญุณูุฉ ูุถูุงู ุญูุธ ุงูุฅุนุฏุงุฏุงุช!**

### **๐ ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ:**
- **โ 4 ูููุงุช ููุญุตุช**
- **โ 4 ูููุงุช ูุชูุงููุฉ (100%)**
- **โ 0 ููู ูุญุชุงุฌ ุชุญุฏูุซ**
- **๐ง 2 ููู ูุญุณู ููุทูุฑ**
- **๐ 1 ุฃูุฑ ุฌุฏูุฏ ูุถุงู**
- **๐ก๏ธ ุถูุงู ุญูุธ 100% ููุฅุนุฏุงุฏุงุช**

### **๐ฏ ุงููุฒุงูุง ุงููุญููุฉ:**
1. **ุชูุงูู ุชููุงุฆู:** ุฌููุน ุงููููุงุช ุชุนูู ูุน PostgreSQL ุฏูู ูุดุงูู
2. **ุญูุธ ูุถููู:** ุฌููุน ุงูุฅุนุฏุงุฏุงุช ูุญููุธุฉ ุจุดูู ุฏุงุฆู
3. **ููุน ุงูุชุฏุงุฎู:** ุญูุงูุฉ ูู ุชุฏุงุฎู ุนูููุงุช ุงูุจุซ
4. **ุชุญูู ูุฑู:** ุฃูุงูุฑ ููุชุญูู ูู ุงููุบุงุฏุฑุฉ ุงูุชููุงุฆูุฉ
5. **ุฃุฏุงุก ูุญุณู:** ุงุณุชูุงุฏุฉ ูู ุณุฑุนุฉ PostgreSQL ูู ุงูุงุณุชุนูุงูุงุช
6. **ูุฑููุฉ ูุงููุฉ:** ุฅููุงููุฉ ุงูุชุจุฏูู ุจูู MongoDB ูPostgreSQL
7. **ุงุณุชูุฑุงุฑ ูุทูู:** ุนุฏู ููุฏุงู ุฃู ุฅุนุฏุงุฏุงุช ุนูุฏ ุฅุนุงุฏุฉ ุงูุชุดุบูู

### **๐ ุงูุฌุงูุฒูุฉ:**
**ุฌููุน ูููุงุช misc ุฌุงูุฒุฉ ููุชูุงููุฉ ุจุงููุงูู ูุน ุถูุงู ุญูุธ ุงูุฅุนุฏุงุฏุงุช ุจูุณุจุฉ 100%!**

### **๐ก ููุงุญุธุฉ ูุงูุฉ:**
**ุชู ุงูุงูุชุฒุงู ุจุทูุจ ุนุฏู ุฅูุดุงุก ูููุงุช ุฌุฏูุฏุฉ ุนุดูุงุฆูุงูุ ูุชู ุงูุชุฑููุฒ ุนูู ุชุญุณูู ุงููููุงุช ุงูุฃุณุงุณูุฉ ููุท (`autoleave.py` ู `broadcast.py`) ุจูููุง ุจุงูู ุงููููุงุช ูุชูุงููุฉ ุชููุงุฆูุงู ุนุจุฑ ุทุจูุฉ `utils.database`.**

### **๐ง ุงูุฅุนุฏุงุฏุงุช ุงูุฌุฏูุฏุฉ ุงููุถุงูุฉ:**
1. **ุญูุธ ุญุงูุฉ ุงููุบุงุฏุฑุฉ ุงูุชููุงุฆูุฉ** - ูุถูุงู ุนุฏู ููุฏุงู ุงูุฅุนุฏุงุฏ
2. **ุญูุธ ุญุงูุฉ ุงูุจุซ** - ูููุน ุชุฏุงุฎู ุนูููุงุช ุงูุจุซ
3. **ุฃูุฑ ุงูุชุญูู ูู ุงููุบุงุฏุฑุฉ ุงูุชููุงุฆูุฉ** - ููุชุญูู ุงููุฑู ูู ุงูุฅุนุฏุงุฏ

---

*ุชู ุฅูุดุงุก ูุฐุง ุงูุชูุฑูุฑ ุชููุงุฆูุงู ุจูุงุณุทุฉ ูุธุงู ูุญุต ุงูุชูุงูู ุงููุชูุฏู*